# Telegram Anti-Farm Bot (Aiogram)
Полное решение для обнаружения массовых входов, автоочистки групп и отдельная Telethon-версия для каналов (userbot).

Особенности:
- Aiogram BOT (только BOT_TOKEN) — для групп/супергрупп: отслеживание new_chat_members, автоудаление при массовых входах, логирование в SQLite.
- Лицензии/ключи — файл keys.txt, генерация `/genkey` (только для администратора), ручная выдача через `/issue` и `/addkey`.
- Магазин: команда `/buy` — инструкция для оплаты через `t.me/ownedgov` и кнопка **Оплатил**. Поддержка рабочего процесса продаж: уведомления администратору, список pending покупок, ручная выдача ключа или автомат по интеграции.
- Telethon userbot — отдельный скрипт для каналов, требует API_ID/API_HASH и сессии пользователя (поддерживает мониторинг массовых входов в каналах и удаление).

Внимание по оплатам (B — крипто-бот / C — Telegram Payments):
- Для полноценной автоматической выдачи ключей при оплате требуется интеграция с платёжным провайдером (крипто-бот или Telegram Payments). В этом репозитории заложены хуки/теги, куда подключать реальную интеграцию. Без этих внешних систем оплата и подтверждение — ручные: покупатель нажимает «Оплатил», админ проверяет платеж у продавца (crypto bot / биржа / Telegram merchant) и выдаёт ключ командой `/issue` или `/genkey`.
- Я оставил места в коде для автоматической интеграции — укажите детали платёжного провайдера и я подключу.

## Как развернуть (Debian VPS)

1. Обновить систему:
```
sudo apt update && sudo apt upgrade -y
```
2. Установить Python и необходимые пакеты:
```
sudo apt install -y python3 python3-venv python3-pip
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
3. В `bot/bot_config.py` заполните `BOT_TOKEN` и `ADMIN_SECRET`. При желании укажите `ADMIN_CHAT_ID` — Telegram ID администратора для уведомлений.
4. Запустите бота:
```
python -m bot.main
```
5. Telethon userbot: если хотите мониторить каналы, зайдите в папку `telethon_bot` и следуйте инструкциям в `telethon_bot/README.md`.

---
